{"version":3,"file":"component---src-pages-reader-tsx-b9bdfa9fe316760692ac.js","mappings":"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","sources":["webpack://power-reader/./src/components/PlayerControls.tsx","webpack://power-reader/./src/components/ReadZone.tsx","webpack://power-reader/./src/pages/reader.tsx"],"sourcesContent":["import React from 'react';\nimport { Link } from 'gatsby';\nimport { SwitchTransition, CSSTransition } from 'react-transition-group';\nimport { FiFastForward, FiGrid, FiPlay, FiPause, FiRewind, FiRotateCcw } from 'react-icons/fi';\nimport { createUseStyles } from 'react-jss';\nimport { Routes } from '../utils/routes';\n\ntype Props = {\n  isPlaying: boolean;\n  onRewind: () => void;\n  onPlayPause: () => void;\n  onFastForward: () => void;\n  onRestart: () => void;\n}\n\nconst TRANSITION_TIME = 150;\n\nconst useStyles = createUseStyles({\n  button: {\n    backdropFilter: 'blur(2px)',\n    background: '#ffffffee',\n    border: 0,\n    borderRadius: 8,\n    boxShadow: '3px 3px 10px #00000011',\n    color: '#333',\n    cursor: 'pointer',\n    display: 'inline-block',\n    fontSize: 28,\n    margin: [0, 8, 4],\n    padding: [8, 10],\n    verticalAlign: 'middle',\n\n    '& svg': {\n      display: 'block'\n    }\n  },\n  buttonTransition: {\n    '&-enter': {\n      transform: 'scale(0)'\n    },\n\n    '&-enter-active': {\n      transform: 'scale(1)',\n      transition: `transform ${TRANSITION_TIME}ms cubic-bezier(0.34, 1.56, 0.64, 1)`\n    },\n\n    '&-enter-done': {\n      transform: 'scale(1)'\n    },\n\n    '&-exit': {\n      transform: 'scale(1)'\n    },\n\n    '&-exit-active': {\n      transform: 'scale(0)',\n      transition: `transform ${TRANSITION_TIME}ms cubic-bezier(0.34, 1.56, 0.64, 1)`\n    }\n  }\n});\n\nexport default function PlayerControls(props: Props) {\n  const classes = useStyles();\n\n  return (\n    <>\n      <Link className={classes.button} to={Routes.Dashboard}><FiGrid /></Link>\n      <button className={classes.button} onClick={props.onRewind}><FiRewind /></button>\n      <button className={classes.button} onClick={props.onPlayPause}>\n        <SwitchTransition>\n          <CSSTransition\n            key={props.isPlaying ? 'true' : 'false'}\n            timeout={TRANSITION_TIME}\n            classNames={classes.buttonTransition}\n          >\n            {props.isPlaying ? <FiPause /> : <FiPlay />}\n          </CSSTransition>\n        </SwitchTransition>\n      </button>\n      <button className={classes.button} onClick={props.onFastForward}><FiFastForward /></button>\n      <button className={classes.button} onClick={props.onRestart}><FiRotateCcw /></button>\n    </>\n  )\n}\n","import React, { useEffect } from 'react';\nimport { createUseStyles } from 'react-jss';\nimport { useUserState } from '../state/user';\nimport { ReaderDocument } from '../state/user';\nimport { documentToLines, getActiveLines } from '../utils/document';\n\ntype Props = {\n  document: ReaderDocument;\n  isPlaying: boolean;\n  onComplete: () => void;\n  speed: number;\n}\n\ntype Styles = {\n  lineProgress: number;\n}\n\nconst useStyles = createUseStyles({\n  readZone: {\n    display: 'flex',\n    justifyContent: 'center'\n  },\n  readZoneCentered: {\n    border: 0,\n    borderLeft: 'solid 2px #33333333',\n    display: 'inline-block',\n    minWidth: 728,\n    padding: [16, 32]\n  },\n  textLine: {\n    fontSize: 24,\n    margin: [8, 0],\n    position: 'relative',\n\n    '&::after': {\n      backdropFilter: 'blur(2px)',\n      background: '#0000000f',\n      bottom: 0,\n      boxShadow: '3px 3px 10px #00000011',\n      content: '\"\"',\n      display: 'block',\n      left: 0,\n      height: '100%',\n      position: 'absolute',\n      transform: ({ lineProgress }: Styles) => `scaleX(${lineProgress / 100})`,\n      transformOrigin: 'left',\n      transition: 'transform 20ms linear',\n      width: '100%',\n      zIndex: -1\n    }\n  },\n  paraTextLine: {\n    fontSize: 24,\n    margin: [8, 0],\n    opacity: 0.1\n  }\n});\n\nexport default function ReadZone({\n  document,\n  isPlaying,\n  onComplete,\n  speed\n}: Props) {\n  const [user, setUser] = useUserState();\n\n  const { content, name, readerPosition } = document;\n\n  const lines = documentToLines(content);\n\n  const { activeLines, lineProgress } = getActiveLines(lines, readerPosition);\n\n  useEffect(() => {\n    if (!isPlaying || typeof window === 'undefined') return;\n    if (document.readerPosition >= document.content.length) onComplete();\n  \n    const timeout = window.setTimeout(() => {\n      const updateDocuments = [...user.documents];\n      const activeDocumentIndex = updateDocuments.indexOf(updateDocuments.find((updateDocument) => updateDocument.id === document.id)!);\n      updateDocuments[activeDocumentIndex] = {\n        ...updateDocuments[activeDocumentIndex],\n        readerPosition: updateDocuments[activeDocumentIndex].readerPosition + 1\n      };\n      setUser({\n        ...user,\n        documents: updateDocuments\n      });\n    }, speed * 1000);\n\n    return () => window.clearTimeout(timeout);\n  }, [document, isPlaying, user, setUser]);\n\n  const classes = useStyles({ lineProgress });\n\n  return (\n    <section>\n      <div className={classes.readZone}>\n        <div className={classes.readZoneCentered}>\n          <p className={classes.paraTextLine}>{ activeLines[0] }</p>\n          <p className={classes.textLine}>{ activeLines[1] }</p>\n          <p className={classes.paraTextLine}>{ activeLines[2] }</p>\n        </div>\n      </div>\n    </section>\n  );\n}\n","import React, { useState } from 'react';\nimport { navigate } from 'gatsby';\nimport { createUseStyles } from 'react-jss';\nimport { Routes } from '../utils/routes';\nimport { useUserState } from '../state/user';\nimport { getDocument } from '../utils/document';\nimport PlayerControls from '../components/PlayerControls';\nimport ReadZone from '../components/ReadZone';\n\nconst useStyles = createUseStyles({\n  '@global': {\n    body: {\n      background: 'linear-gradient(125deg, #ffffff, #f0f0f0) !important'\n    }\n  },\n  controlsContainer: {\n    margin: [32, 0, 160],\n    opacity: 0.1,\n    padding: 16,\n    textAlign: 'center',\n    transition: 'opacity 300ms ease-in-out',\n\n    '&:hover, &:focus': {\n      opacity: 1\n    }\n  }\n});\n\nexport default function Reader() {\n  const classes = useStyles();\n  const [user, setUser] = useUserState();\n  const [isPlaying, setIsPlaying] = useState(false);\n\n  const document = getDocument(user);\n\n  if (!document) {\n    console.error(\"Couldn't find document with this ID\");\n    if (typeof window !== 'undefined') navigate(Routes.Dashboard);\n    return <main />;\n  }\n\n  function onPlayPause() {\n    setIsPlaying(!isPlaying);\n  }\n\n  function onRewind() {\n    const updateDocuments = [...user.documents];\n    updateDocuments[updateDocuments.indexOf(document!)] = {\n      ...updateDocuments[updateDocuments.indexOf(document!)],\n      readerPosition: Math.max(document!.readerPosition - 100, 0)\n    };\n    setUser({\n      ...user,\n      documents: updateDocuments\n    });\n  }\n\n  function onFastForward() {\n    const updateDocuments = [...user.documents];\n    updateDocuments[updateDocuments.indexOf(document!)] = {\n      ...updateDocuments[updateDocuments.indexOf(document!)],\n      readerPosition: Math.min(document!.readerPosition + 100, document!.content.length)\n    };\n    setUser({\n      ...user,\n      documents: updateDocuments\n    });\n  }\n\n  function onRestart() {\n    const updateDocuments = [...user.documents];\n    updateDocuments[updateDocuments.indexOf(document!)] = {\n      ...updateDocuments[updateDocuments.indexOf(document!)],\n      readerPosition: 0\n    };\n    setUser({\n      ...user,\n      documents: updateDocuments\n    });\n  }\n\n  return (\n    <main>\n      <section className={classes.controlsContainer}>\n        <h1>{ document.name }</h1>\n        <PlayerControls\n          isPlaying={isPlaying}\n          onRewind={onRewind}\n          onPlayPause={onPlayPause}\n          onFastForward={onFastForward}\n          onRestart={onRestart}\n        />\n      </section>\n      <ReadZone\n        document={document}\n        isPlaying={isPlaying}\n        onComplete={onPlayPause}\n        speed={1 / user.readSpeed}\n      />\n    </main>\n  );\n}\n"],"names":["TRANSITION_TIME","useStyles","createUseStyles","button","backdropFilter","background","border","borderRadius","boxShadow","color","cursor","display","fontSize","margin","padding","verticalAlign","buttonTransition","transform","transition","PlayerControls","props","classes","React","Link","className","to","Routes","Dashboard","FiGrid","onClick","onRewind","FiRewind","onPlayPause","SwitchTransition","CSSTransition","key","isPlaying","timeout","classNames","FiPause","FiPlay","onFastForward","FiFastForward","onRestart","FiRotateCcw","readZone","justifyContent","readZoneCentered","borderLeft","minWidth","textLine","position","bottom","content","left","height","_ref","lineProgress","transformOrigin","width","zIndex","paraTextLine","opacity","ReadZone","_ref2","document","onComplete","speed","user","setUser","useUserState","name","readerPosition","lines","documentToLines","activeLines","getActiveLines","useEffect","window","length","setTimeout","updateDocuments","_toConsumableArray","documents","activeDocumentIndex","indexOf","find","updateDocument","id","clearTimeout","body","controlsContainer","textAlign","Reader","setIsPlaying","useState","getDocument","console","error","navigate","Math","max","min","readSpeed"],"sourceRoot":""}